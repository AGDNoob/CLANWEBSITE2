/* ==========================================================================
   PREMIUM CLAN DASHBOARD DESIGN
   ==========================================================================
   Author: Gemini
   Version: 1.4 (Animationen & UI-Feinschliff wiederhergestellt)
   ========================================================================== */

/* ==========================================================================
   1. DESIGN SYSTEM & CSS-VARIABLEN (CUSTOM PROPERTIES)
   ========================================================================== */
:root {
  /* Farbpalette: Dracula Theme mit CoC Akzenten */
  --color-background: #282a36; /* Dunkler Hintergrund */
  --color-background-secondary: #383a59; /* Etwas hellerer Hintergrund für Container */
  --color-background-glass: rgba(68, 71, 90, 0.6);
  --color-current-line: #44475a; /* Akzent für aktive Elemente, Ränder */
  --color-foreground: #f8f8f2; /* Heller Text */
  --color-comment: #6272a4;    /* Weniger wichtiger Text, Kommentare */

  /* Akzentfarben */
  --color-cyan: #8be9fd;
  --color-green: #50fa7b;
  --color-orange: #ffb86c;
  --color-pink: #ff79c6;
  --color-purple: #bd93f9;
  --color-red: #ff5555;
  --color-yellow: #f1fa8c;

  /* Typografie */
  --font-family-sans: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
  --font-family-mono: 'Fira Code', 'JetBrains Mono', monospace;
  
  --font-size-base: 16px;
  --font-size-sm: 0.875rem; /* 14px */
  --font-size-md: 1rem;    /* 16px */
  --font-size-lg: 1.125rem;/* 18px */
  --font-size-xl: 1.25rem; /* 20px */

  --font-weight-light: 300;
  --font-weight-normal: 400;
  --font-weight-bold: 700;

  /* Abstände (Spacing) */
  --spacing-xs: 0.25rem; /* 4px */
  --spacing-sm: 0.5rem;  /* 8px */
  --spacing-md: 1rem;    /* 16px */
  --spacing-lg: 1.5rem;  /* 24px */
  --spacing-xl: 2rem;    /* 32px */
  --spacing-xxl: 4rem;   /* 64px */

  /* Sonstiges */
  --border-radius-sm: 4px;
  --border-radius-md: 8px;
  --border-radius-lg: 16px;
  --box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2), 0 6px 6px rgba(0, 0, 0, 0.25);
  --box-shadow-inset: inset 0 2px 4px rgba(0, 0, 0, 0.2);
  --transition-fast: all 0.2s ease-in-out;
  --transition-slow: all 0.4s ease-in-out;
}

/* ==========================================================================
   2. GLOBAL RESET & BASE STYLES
   ========================================================================== */
*, *::before, *::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  font-size: var(--font-size-base);
  scroll-behavior: smooth;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

body {
  font-family: var(--font-family-sans);
  font-weight: var(--font-weight-normal);
  line-height: 1.6;
  color: var(--color-foreground);
  background: var(--color-background);
  overflow-x: hidden;
}

img {
  max-width: 100%;
  height: auto;
  display: block;
}

/* ==========================================================================
   3. TYPOGRAFIE
   ========================================================================== */
h1, h2, h3, h4, h5, h6 {
  font-weight: var(--font-weight-bold);
  line-height: 1.2;
  margin-bottom: var(--spacing-md);
  color: var(--color-cyan);
  letter-spacing: -0.5px;
}

h1 { font-size: 2.5rem; }
h2 { font-size: 2rem; color: var(--color-purple); }
h3 { font-size: 1.5rem; color: var(--color-green); }

p {
  margin-bottom: var(--spacing-md);
  max-width: 75ch;
  color: var(--color-comment);
}

a {
  color: var(--color-pink);
  text-decoration: none;
  transition: var(--transition-fast);
  position: relative;
  padding-bottom: 2px;
}

a:hover {
  color: var(--color-yellow);
}

/* Animierter Unterstrich-Effekt */
a::after {
  content: '';
  position: absolute;
  width: 100%;
  transform: scaleX(0);
  height: 2px;
  bottom: 0;
  left: 0;
  background-color: var(--color-yellow);
  transform-origin: bottom right;
  transition: transform 0.25s ease-out;
}

a:hover::after {
  transform: scaleX(1);
  transform-origin: bottom left;
}

/* ==========================================================================
   4. LAYOUT
   ========================================================================== */
.app-container {
  display: flex;
  min-height: 100vh;
}

.sidebar {
  width: 260px;
  background-color: var(--color-background-secondary);
  padding: var(--spacing-lg);
  border-right: 1px solid var(--color-current-line);
  transition: transform 0.3s ease-in-out;
  z-index: 1000;
}

.main-content {
  flex-grow: 1;
  padding: var(--spacing-xl);
  overflow-y: auto;
}

.page {
  display: none;
}

.page.active {
  display: block;
  animation: fadeIn 0.5s ease-in-out;
}

.hidden {
  display: none !important;
}

.card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: var(--spacing-lg);
}

.analytics-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-lg);
}

.analytics-grid .full-width {
    grid-column: 1 / -1;
}

/* ==========================================================================
   5. KOMPONENTEN
   ========================================================================== */

/* ----- Buttons ----- */
button, .btn {
  display: inline-block;
  padding: var(--spacing-sm) var(--spacing-lg);
  border: none;
  border-radius: var(--border-radius-md);
  font-weight: var(--font-weight-bold);
  cursor: pointer;
  transition: var(--transition-fast);
  text-align: center;
  background: var(--color-current-line);
  color: var(--color-foreground);
  border: 1px solid var(--color-comment);
}

button:hover, .btn:hover {
  background-color: var(--color-comment);
  transform: translateY(-2px);
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
}

.cta-button {
  background: linear-gradient(45deg, var(--color-green), var(--color-cyan));
  color: var(--color-background);
  border: none;
  padding: var(--spacing-md) var(--spacing-xl);
  font-size: var(--font-size-lg);
}
.cta-button:hover {
    box-shadow: 0 5px 15px rgba(80, 250, 123, 0.4);
}

/* ----- Sidebar / Navigation ----- */
.sidebar-header {
  margin-bottom: var(--spacing-xl);
  text-align: center;
}
.sidebar-header h3 {
  color: var(--color-foreground);
}

.sidebar-nav {
  list-style: none;
}

.nav-link {
  display: block;
  padding: var(--spacing-sm) var(--spacing-md);
  margin-bottom: var(--spacing-sm);
  border-radius: var(--border-radius-md);
  transition: var(--transition-fast);
  font-weight: var(--font-weight-bold);
  color: var(--color-comment);
}

.nav-link:hover {
  background-color: var(--color-current-line);
  color: var(--color-cyan);
  transform: translateX(5px);
}

.nav-link.active {
  background-color: var(--color-purple);
  color: var(--color-background);
  box-shadow: 0 4px 8px rgba(189, 147, 249, 0.3);
}

/* ----- Generische Boxen & Karten ----- */
.dashboard-box, .stats-box {
    background-color: var(--color-background-secondary);
    border-radius: var(--border-radius-lg);
    padding: var(--spacing-lg);
    border: 1px solid var(--color-current-line);
    margin-bottom: var(--spacing-xl);
}

.member-card, .raid-card {
  background-color: var(--color-background-secondary);
  border-radius: var(--border-radius-md);
  padding: var(--spacing-md);
  border: 1px solid var(--color-current-line);
  transition: var(--transition-slow);
  cursor: pointer;
}

.member-card:hover, .raid-card:hover {
  transform: translateY(-5px);
  box-shadow: var(--box-shadow);
  border-color: var(--color-green);
}

/* ----- Tabellen (Überarbeitet) ----- */
.stats-table {
  width: 100%;
  border-collapse: collapse;
}

.stats-table th, .stats-table td {
  padding: var(--spacing-md);
  text-align: left;
  border-bottom: 1px solid var(--color-current-line);
}

.stats-table thead {
  color: var(--color-purple);
  font-size: var(--font-size-sm);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.stats-table tbody tr {
    transition: var(--transition-fast);
}

.stats-table tbody tr:nth-child(even) {
    background-color: rgba(0,0,0,0.1); /* Subtiler Zebra-Effekt */
}

.stats-table tbody tr:hover {
  background-color: var(--color-current-line);
}

.stats-table tbody tr:last-child td {
    border-bottom: none;
}

.donation-ratio.good { color: var(--color-green); font-weight: var(--font-weight-bold); }
.donation-ratio.bad { color: var(--color-red); font-weight: var(--font-weight-bold); }


/* ----- Akkordeon (für Warlog) ----- */
.accordion {
    cursor: pointer;
    transition: var(--transition-fast);
}
.accordion:hover {
    border-color: var(--color-cyan);
}
.accordion.active .accordion-arrow {
    transform: rotate(180deg);
}

.accordion-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.accordion-content {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease-in-out;
    padding-top: 0;
    margin-top: 0;
}
.accordion.active .accordion-content {
    padding-top: var(--spacing-lg);
    margin-top: var(--spacing-lg);
}

/* ----- Mobile Header & Overlay ----- */
.mobile-header {
    display: none;
}
#mobile-overlay {
    display: none;
}


/* ==========================================================================
   6. SEITENSPEZIFISCHE STILE: CLAN-INFOS
   ========================================================================== */
#clan-header {
    margin-bottom: var(--spacing-xl);
    text-align: center;
}
#clan-description {
    max-width: 60ch;
    margin: 0 auto var(--spacing-lg) auto;
}
#clan-stats span {
    margin: 0 var(--spacing-sm);
    font-weight: var(--font-weight-bold);
    color: var(--color-cyan);
}

.member-card-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-sm);
}
.member-card-body {
    display: flex;
    justify-content: space-between;
    font-size: var(--font-size-sm);
    color: var(--color-comment);
}

/* Spielerprofil */
.profile-card {
    background: var(--color-background-secondary);
    border-radius: var(--border-radius-lg);
    padding: var(--spacing-xl);
    max-width: 600px;
    margin: var(--spacing-lg) auto;
}
.profile-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
    padding-bottom: var(--spacing-lg);
    border-bottom: 1px solid var(--color-current-line);
}
.profile-header img {
    width: 80px;
}
.profile-stats {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-md);
}
.stat-item {
    background-color: var(--color-background);
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--border-radius-md);
    display: flex;
    justify-content: space-between;
}
.stat-item span:first-child {
    color: var(--color-comment);
}
.stat-item span:last-child {
    font-weight: var(--font-weight-bold);
}

/* ==========================================================================
   7. SEITENSPEZIFISCHE STILE: STATISTIKEN & CHARTS
   ========================================================================== */
.chart-container {
    height: 400px;
    position: relative;
}
.chart-container-half {
    height: 300px;
    position: relative;
}

/* ==========================================================================
   8. SEITENSPEZIFISCHE STILE: KRIEGSZENTRALE
   ========================================================================== */
#current-war-box {
    cursor: pointer;
}
.war-header, .war-scores {
    display: flex;
    justify-content: space-between;
    align-items: center;
    text-align: center;
}
.war-header {
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
}
.clan-side, .opponent-side {
    flex: 1;
}
.vs-separator {
    font-size: var(--font-size-xl);
    color: var(--color-red);
    font-weight: var(--font-weight-bold);
}

.war-scores {
    background-color: var(--color-background);
    padding: var(--spacing-md);
    border-radius: var(--border-radius-md);
    margin-bottom: var(--spacing-lg);
}
.war-scores span {
    flex: 1;
}
.war-scores span:nth-child(2),
.war-scores span:nth-child(5) {
    font-weight: var(--font-weight-bold);
    color: var(--color-comment);
}
.war-state {
    text-align: center;
    color: var(--color-orange);
}

/* Detaillierte Kriegsansicht */
.detailed-war-clans {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-lg);
}

.war-player-card {
    background-color: var(--color-background-secondary);
    border-radius: var(--border-radius-md);
    margin-bottom: var(--spacing-sm);
    padding: var(--spacing-sm);
    font-size: var(--font-size-sm);
}

.war-player-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: var(--font-weight-bold);
    margin-bottom: var(--spacing-xs);
}

.player-map-pos {
    background-color: var(--color-current-line);
    border-radius: 50%;
    width: 24px;
    height: 24px;
    display: inline-flex;
    justify-content: center;
    align-items: center;
}

.player-name {
    flex-grow: 1;
}

.attacks-container {
    padding-left: 32px; /* Einrücken unter der Map-Position */
}

.attack-info {
    display: flex;
    justify-content: space-between;
    background-color: var(--color-background);
    padding: var(--spacing-xs) var(--spacing-sm);
    border-radius: var(--border-radius-sm);
    margin-top: var(--spacing-xs);
}

.attack-result {
    font-weight: var(--font-weight-bold);
}

/* Feinschliff für Warlog */
.warlog-entry {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--border-radius-md);
    margin-bottom: var(--spacing-sm);
    border-left: 5px solid;
}
.warlog-entry.win {
    background-color: rgba(80, 250, 123, 0.1);
    border-left-color: var(--color-green);
}
.warlog-entry.lose {
    background-color: rgba(255, 85, 85, 0.1);
    border-left-color: var(--color-red);
}
.warlog-entry.tie {
    background-color: rgba(68, 71, 90, 0.5);
    border-left-color: var(--color-current-line);
}
.war-result {
    font-weight: bold;
}
.war-details {
    font-size: var(--font-size-sm);
    color: var(--color-comment);
}

/* ==========================================================================
   9. SEITENSPEZIFISCHE STILE: CWL
   ========================================================================== */
.day-selector-grid {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-sm);
}
.day-selector-btn {
    flex-grow: 1;
}
.day-selector-btn.active {
    background: var(--color-purple);
    color: var(--color-background);
    border-color: var(--color-purple);
}

.cwl-stats-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: var(--spacing-lg);
}

#cwl-mvp-box {
    background: linear-gradient(45deg, var(--color-purple), var(--color-pink));
    color: var(--color-foreground);
}
#cwl-mvp-box h3 {
    color: var(--color-yellow);
}
#cwl-mvp-content p {
    color: var(--color-foreground);
}

/* Bonus Rechner */
.bonus-rechner-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
}
.settings-box {
    background-color: var(--color-background);
    padding: var(--spacing-md);
    border-radius: var(--border-radius-md);
}
.setting-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--spacing-sm);
}
.setting-item label {
    color: var(--color-comment);
}
.setting-item input {
    width: 60px;
    background-color: var(--color-current-line);
    border: 1px solid var(--color-comment);
    color: var(--color-foreground);
    padding: var(--spacing-xs);
    border-radius: var(--border-radius-sm);
    text-align: center;
}

.bonus-results-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-xl);
    align-items: flex-start;
}

/* ==========================================================================
   10. SEITENSPEZIFISCHE STILE: LABOR-SPION
   ========================================================================== */

#page-lab h2 {
    margin-bottom: var(--spacing-sm);
}
#page-lab .dashboard-box {
    margin-bottom: var(--spacing-xl);
}

.loading-state {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    padding: var(--spacing-xxl);
    min-height: 400px;
}

/* Spinner Animation (Überarbeitet) */
.spinner {
    width: 60px;
    height: 60px;
    position: relative;
    animation: spin 1.2s linear infinite;
    margin-bottom: var(--spacing-lg);
}

.spinner::before,
.spinner::after {
    content: "";
    position: absolute;
    border-radius: 50%;
}

.spinner::before {
    width: 100%;
    height: 100%;
    background: linear-gradient(0deg, var(--color-purple) 0%, var(--color-pink) 100%);
    animation: spin 1.2s linear infinite reverse; /* Rotiert in die andere Richtung */
}

.spinner::after {
    width: 85%;
    height: 85%;
    background: var(--color-background-secondary);
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

.lab-table-container {
    overflow-x: auto; /* Wichtig für mobile Ansicht */
    -webkit-overflow-scrolling: touch; /* Flüssigeres Scrollen auf iOS */
    border: 1px solid var(--color-current-line);
    border-radius: var(--border-radius-lg);
    background-color: var(--color-background-secondary);
    box-shadow: var(--box-shadow-inset);
}

.lab-table {
    width: 100%;
    min-width: 600px; /* Mindestbreite, um Umbrüche zu vermeiden */
    border-collapse: collapse;
}

.lab-table th,
.lab-table td {
    padding: var(--spacing-sm) var(--spacing-md); /* Vertikaler Abstand reduziert */
    text-align: center;
    white-space: nowrap;
    border-bottom: 1px solid var(--color-current-line);
    font-size: var(--font-size-sm);
}

.lab-table th {
    font-size: 0.8rem; /* Macht die Schrift im Header etwas kleiner */
    padding-top: var(--spacing-sm);
    padding-bottom: var(--spacing-sm);
}

.lab-table th {
    background-color: var(--color-background-glass);
    color: var(--color-purple);
    font-weight: var(--font-weight-bold);
    position: sticky; /* Header bleibt beim Scrollen sichtbar */
    top: 0;
    backdrop-filter: blur(5px);
}

.lab-table tbody tr:last-child td {
    border-bottom: none;
}

.lab-table tbody tr:hover {
    background-color: var(--color-current-line);
}

/* Erster Tabelleneintrag (Spielername) linksbündig */
.lab-table th:first-child,
.lab-table td:first-child {
    text-align: left;
    padding-left: var(--spacing-lg);
    position: sticky; /* Spielernamen bleiben beim horizontalen Scrollen sichtbar */
    left: 0;
    background-color: var(--color-background-secondary); /* Sorgt für Lesbarkeit beim Scrollen */
}

/* Leichte Anpassung für den Hover-Effekt des fixierten Spieleramens */
.lab-table tbody tr:hover td:first-child {
    background-color: var(--color-current-line);
}

.player-cell {
    display: flex;
    flex-direction: column;
}

.player-th-sublabel {
    font-size: 0.75rem;
    color: var(--color-comment);
}

.lab-table .is-maxed {
    color: var(--color-yellow);
    font-weight: var(--font-weight-bold);
}


/* ==========================================================================
   11. RESPONSIVE DESIGN
   ========================================================================== */
@media (max-width: 1024px) {
    .sidebar {
        position: fixed;
        left: 0;
        top: 0;
        height: 100%;
        transform: translateX(-100%);
    }
    .sidebar.open {
        transform: translateX(0);
    }
    .main-content {
        padding: var(--spacing-lg);
        padding-top: 80px; /* Platz für den mobilen Header */
        margin-left: 0;
        width: 100%;
    }
    .mobile-header {
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        background-color: var(--color-background-secondary);
        padding: var(--spacing-sm) var(--spacing-md);
        z-index: 999;
        border-bottom: 1px solid var(--color-current-line);
    }
    #hamburger-btn {
        font-size: 1.5rem;
        background: transparent;
        border: none;
    }
    #mobile-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        z-index: 998;
        display: none;
    }
    #mobile-overlay.open {
        display: block;
    }
    .bonus-results-grid,
    .detailed-war-clans,
    .analytics-grid {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 600px) {
    h1 { font-size: 2rem; }
    h2 { font-size: 1.75rem; }

    .war-header {
        flex-direction: column;
    }
    .vs-separator {
        margin: var(--spacing-sm) 0;
    }
}


/* ==========================================================================
   12. HELPER & ANIMATIONEN
   ========================================================================== */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

.error-message {
    color: var(--color-red);
    background-color: rgba(255, 85, 85, 0.1);
    padding: var(--spacing-md);
    border-radius: var(--border-radius-md);
    border: 1px solid var(--color-red);
    text-align: center;
}

